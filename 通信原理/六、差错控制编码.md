# 差错控制编码

信道传输信号时，不可避免地会发生错误。

通过引入差错控制编码，可以实现自动纠错，从而**降低误比特率**

## 差错控制的基本方式
### 差错发生模式
1. 随机差错：由随机热噪声引起的差错，对应的信道称为随机信道
2. 突发差错：差错出现时是一连串的，对应的信道称为突发信道
3. 混合差错：既有突发差错又有随机差错，对应的信道称为混合信道
### 差错控制方式
常用的差错控制方式有三种，检错重发（ARQ）、前向纠错、混合ARQ

这三种差错控制方式的原理如图所示

![1686044691746](../image/%E5%B7%AE%E9%94%99%E6%8E%A7%E5%88%B6%E7%BC%96%E7%A0%81/1686044691746.png)

三种方式的特点：

1. 检错重发：可靠性高，实时性差，传输效率低

2. 前向纠错：可靠性稍差，实时性高，传输效率高

3. 混合ARQ：两者的折中

### 差错控制编码分类
1. 检错码与纠错码：差错控制编码的功能不同
2. 线性码与非线性码：码字是否组成线性空间
3. 分组码与卷积码：信息位和校验位之间的约束方式不同
4. 系统码与非系统码：信息位在编码后的形式不同
5. 代数码、几何码与算数码：构造时的数学方法不同

### 香农信道编码定理与香农限
根据香农信道编码定理，信道容量
$$C = W\log_2(1+\frac{S}{N}) = W\log_2(1+\frac{E_bR_b}{N_0W})$$
其中， $W$ 是带宽， $\frac{S}{N}$ 是信噪比, $E_b$ 是比特速率， $R_b$ 是比特速率， $N_0$ 是单位带宽内的噪声功率谱密度。

该定理指出，若 $R_b \leq C$ ，则一定存在一种信道编码方式，使错误概率 $P$ 随码长 $n$ 的增加指数减小。
$$P\leq e^{-nE(R)}$$

直白点的意思就是，只要 $R_b$ 不大于 $C$ ，就总有一种编码方式能够不出错的传输

该定理有两条结论：
1. 在码长 $n$ 和信息速率 $R_b$ 一定的情况下，增大信道容量 $C$ 可以减小 $P$
2. 在信道容量 $C$ 和信息速率 $R_b$ 一定的情况下，增大码长 $n$ 可以减小 $P$

这就是差错控制编码的主要思路

### 检错和纠错的基本原理

基本原理就是增加校验信息，实现方法包括重复编码、增加校验位等等方式

为了定量描述检错和纠错的性能，需要引入码重和码距两个概念

码重，定义为码组中非零位的数目

码距，汉明距，定义为两个码组对应位上值不同的位的数目（直白点就是把两个二进制数按位异或并求和，数学上又称异或和、模2加法）

最小码距 $d_{\min}$ 与编码的检错和纠错能力一般有下列结论：
1. 码组内检测 $e$ 个误码，要求 $d_{\min} \geq e+1$
2. 码组内纠正 $t$ 个误码，要求 $d_{\min} \geq 2t+1$
3. 在一个码组内纠正 $t$ 个误码，同时检测 $e(e\geq t)$ 个误码，要求 $d_{\min} \geq t+e+1$
4. 最小码距越大，说明码字间的差别越大，抗干扰能力越强

直观一点的理解可以见下图

![1686108563362](../image/%E5%B7%AE%E9%94%99%E6%8E%A7%E5%88%B6%E7%BC%96%E7%A0%81/1686108563362.png)

### 实用简单检错码

#### 奇偶校验码
在码元序列 $M$ 末尾加上一位校验位 $a_0$ ，使整个码元序列的0的个数为奇数或偶数。

这种校验方式只能发现单数个或奇数个错误，检错能力并不高，最小码距 $d_{\min} = 2$

实现时只要对 $M$ 按位异或即可得到 $a_0$

#### 水平奇偶校验码

将经过奇偶校验编码的码元序列排列成方阵，但按列传输，接收时重新按行进行奇偶校验，称为水平奇偶校验码

![1686047619816](../image/%E5%B7%AE%E9%94%99%E6%8E%A7%E5%88%B6%E7%BC%96%E7%A0%81/1686047619816.png)

#### 水平垂直奇偶校验码

在水平奇偶校验码的基础上按列添加奇偶校验码，称为水平垂直奇偶校验码

![1686047631567](../image/%E5%B7%AE%E9%94%99%E6%8E%A7%E5%88%B6%E7%BC%96%E7%A0%81/1686047631567.png)


## 线性分组码

码字构成一个线性空间的编码称为线性分组码。

线性分组码由 $k$ 位信息和 $r$ 位校验子组成，总长为 $n$ ，记为 $(n,k)$ 码。则其信息位 $M=[a_0, a_1,\cdots,a_k]$ ，校验子 $S=[s_0, s_1,\cdots,s_r]$ ，码字 $C=[c_0, c_1,\cdots,c_{n}]$ 

<!-- 最常见的线性分组码是二元码。二元码主要有两个性质：
1. 封闭性：任意两个码字的异或和仍为一个码字
2. 重量即距离：码间的最小距离等于非零码的最小重量

一般来说，线性分组码拥有校验子 $S$ ，校验子可由校验方程组生成。由 $r$ 个校验方程计算得到的校验子有 $r$ 位，可以指示 $2^r-1$ 中错误。 -->


### 生成矩阵

生成矩阵 $G$ 是一个 $k\times n$ 的矩阵，其前 $k$ 列为单位阵 $I_k$ ，后 $r$ 列为校验阵的转置 $P^T$ ，即
$$G=\big[I_k ~~ P^T\big]$$

已知信息位 $M=[a_0, a_1,\cdots,a_k]$ ，则码字
$$A = M\cdot G$$

### 校验矩阵

校验矩阵 $H$ 是一个 $r\times n$ 的矩阵，其前 $k$ 列为校验阵 $P$ ，后 $r$ 列为单位阵 $I_r$
$$H = \big[P ~~ I_r\big]$$

已知接收到的码值 $C = [c_0, c_1,\cdots,c_n]$ ，则校验子
$$S = C\cdot H^T$$
根据校验子即可进一步纠错

### 汉明码

汉明码是一种常见的线性分组码，其特点是可以纠正单个错误。因此其最小汉明距为 $d=3$，纠错能力为 $t=1$ 。若已知校验子有 $r$ 位，则根据汉明码的特点，可以得出 $(n,k)$ 汉明码的构造如下：

$$n = 2^r-1$$
$$k = n-r$$

对于能纠正 $t$ 个错误的 $(n,r)$ 线性分组码，其校正子的数目满足
$$2^r \geq \sum_{i=0}^{t} {n \choose i}$$

该式又称汉明界，汉明码是达到汉明界的一种码。达到汉明界的又称为完备码。

迄今为止还有一组二元完备码，记为 $(23,12)$ 格雷码，其纠错能力为3
$$2^{23-12} = 2^{11} = \sum_{i=0}^3 {n\choose i}$$

## 扩展码

对于 $(n,k)$ 码，其校验矩阵为 $H$ ，可在其中新增 $l$ 列和 $l$ 行，可得到 $(n+1,k)$ 扩展码，即增加了校验位数，从而增大最小汉明距
## 缩短码
对于 $(n,k)$ 码，其校验矩阵为 $H$ ，可将其左侧的 $s$ 列删除，从而得到 $(n-s, k-s)$ 缩短码，保持校验位不变，减少参与编码的信息位，从而增大最小汉明距

## 线性码的最小汉明距界限
线性码的纠错能力与该码的最小汉明距密切相关。为了知晓线性码的最小汉明距的上下界，引入以下概念：

汉明界，是给定 $r,t$ 约束下达到的最小汉明距的上界
$$r\geq \log_2 ~ \sum_{i=0}^t {n\choose i}, d_{\min} =2t+1$$

普罗特金界，是给定 $r$ 约束下达到的最小汉明距的上界
$$r\geq 2d_{\min}-2-\log_2 d_{\min}$$

吉尔伯特-瓦尔沙莫夫界，是给定 $r,d$ 约束下达到的最小汉明距的下界
$$r\geq \sum_{i=0}^{d_{\min}-2} {n-1 \choose i}$$

![1686399376758](../image/%E5%B7%AE%E9%94%99%E6%8E%A7%E5%88%B6%E7%BC%96%E7%A0%81/1686399376758.png)

码率较高（ $\frac{k}{n}$ 较大）的码，汉明界是较好的上界；码率较低时，普罗特金是较好的上界

## 循环码

循环码是一种特殊的线性分组码，其码字的任意循环移位仍为一个码字。例如，设 $(a_{n-1} a_{n-2} \cdots a_1a_0)$ 为一码字，则 $(a_{n-2} \cdots a_1a_0a_{n-1})$ 仍为一码字


### 生成多项式
后面都不会了，代数看不懂 😭

### 循环码的生成矩阵和校验矩阵

### 循环码的编码器

### 循环码的译码器

### 循环冗余校验码

